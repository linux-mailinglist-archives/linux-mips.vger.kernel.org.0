Return-Path: <linux-mips-owner@vger.kernel.org>
X-Original-To: lists+linux-mips@lfdr.de
Delivered-To: lists+linux-mips@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id D0BCD77EFB
	for <lists+linux-mips@lfdr.de>; Sun, 28 Jul 2019 12:03:36 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1725978AbfG1KDg (ORCPT <rfc822;lists+linux-mips@lfdr.de>);
        Sun, 28 Jul 2019 06:03:36 -0400
Received: from foss.arm.com ([217.140.110.172]:59972 "EHLO foss.arm.com"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1725961AbfG1KDg (ORCPT <rfc822;linux-mips@vger.kernel.org>);
        Sun, 28 Jul 2019 06:03:36 -0400
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
        by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 7088D344;
        Sun, 28 Jul 2019 03:03:35 -0700 (PDT)
Received: from big-swifty.misterjones.org (unknown [172.31.20.19])
        by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id 5A6303F694;
        Sun, 28 Jul 2019 03:03:32 -0700 (PDT)
Date:   Sun, 28 Jul 2019 11:03:31 +0100
Message-ID: <86wog2mq6k.wl-marc.zyngier@arm.com>
From:   Marc Zyngier <marc.zyngier@arm.com>
To:     Martin Blumenstingl <martin.blumenstingl@googlemail.com>
Cc:     tglx@linutronix.de, jason@lakedaemon.net, ralf@linux-mips.org,
        paul.burton@mips.com, jhogan@kernel.org, robh+dt@kernel.org,
        linux-mips@vger.kernel.org, devicetree@vger.kernel.org,
        linux-kernel@vger.kernel.org, mark.rutland@arm.com,
        john@phrozen.org, hauke@hauke-m.de
Subject: Re: [PATCH 5/5] MIPS: dts: lantiq: danube: easy50712: route the PCI_INTA IRQ through EBU
In-Reply-To: <20190727175315.28834-6-martin.blumenstingl@googlemail.com>
References: <20190727175315.28834-1-martin.blumenstingl@googlemail.com>
        <20190727175315.28834-6-martin.blumenstingl@googlemail.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 EasyPG/1.0.0 Emacs/26
 (aarch64-unknown-linux-gnu) MULE/6.0 (HANACHIRUSATO)
Organization: ARM Ltd
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-mips-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-mips.vger.kernel.org>
X-Mailing-List: linux-mips@vger.kernel.org

On Sat, 27 Jul 2019 18:53:15 +0100,
Martin Blumenstingl <martin.blumenstingl@googlemail.com> wrote:
> 
> EBU provides an interrupt line for the PCI_INTA interrupt. Route
> easy50712's PCI interrupt to EBU so the interrupt line is configured
> correctly (using IRQ_TYPE_LEVEL_LOW, this was previously hardcoded in
> the PCI driver) and ACKed properly.
> 
> Signed-off-by: Martin Blumenstingl <martin.blumenstingl@googlemail.com>
> ---
>  arch/mips/boot/dts/lantiq/easy50712.dts | 4 +++-
>  1 file changed, 3 insertions(+), 1 deletion(-)
> 
> diff --git a/arch/mips/boot/dts/lantiq/easy50712.dts b/arch/mips/boot/dts/lantiq/easy50712.dts
> index 1ce20b7d05cb..33c26b93cfc9 100644
> --- a/arch/mips/boot/dts/lantiq/easy50712.dts
> +++ b/arch/mips/boot/dts/lantiq/easy50712.dts
> @@ -1,6 +1,8 @@
>  // SPDX-License-Identifier: GPL-2.0
>  /dts-v1/;
>  
> +#include <dt-bindings/interrupt-controller/irq.h>
> +
>  /include/ "danube.dtsi"
>  
>  / {
> @@ -105,7 +107,7 @@
>  			lantiq,bus-clock = <33333333>;
>  			interrupt-map-mask = <0xf800 0x0 0x0 0x7>;
>  			interrupt-map = <
> -				0x7000 0 0 1 &icu0 29 1 // slot 14, irq 29
> +				0x7000 0 0 1 &ebu0 0 IRQ_TYPE_LEVEL_LOW // slot 14
>  			>;
>  			gpios-reset = <&gpio 21 0>;
>  			req-mask = <0x1>;		/* GNT1 */
> -- 
> 2.22.0
> 

Are you OK with breaking compatibility between kernel and DT? It
usually isn't very nice for users...

Thanks,

	M.

-- 
Jazz is not dead, it just smells funny.
